<script>
//Returns the value of a parameter existing in the page's URL or ' ' if not exists.
function getParameterFromURL(name) {
  var url = window.location.href;
  var name = name.replace(/[\[\]]/g, '\\$&');
  var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
    results = regex.exec(url);
  if (!results) return null;
  if (!results[2]) return '';
  return (results[2].replace(/\+/g, ' '));
}

// generateUrl returns the URL to use behind the iOS and Android "Download" buttons on a landing page, based on the source of the page visitor.
function generateUrl() {
  var oneLinkURL = 'https://yourapp.onelink.me/abcd';   // **** Replace with your own basic OneLink URL ****
  var finalURL = "";
  var partnerIDParam = '?pid=';
  var campaignParam = '&c=';
  var contentParam = '&af_sub1=';
  var utmSourceParam = '&utm_source=';
  var utmCampaignParam = '&utm_campaign=';
  var utmContentParam = '&utm_content=';
  var sourceValue;
  var campaignValue;
  var contentValue;

  if (getParameterFromURL('utm_source')) {
    sourceValue = getParameterFromURL('utm_source');
  } else {
    sourceValue = 'unknown';
  }

  if (getParameterFromURL('utm_campaign')) {
    campaignValue = getParameterFromURL('utm_campaign');
  } else {
    campaignValue = 'unknown';
  }

  contentValue = encodeURIComponent(window.location.href);


  finalURL = oneLinkURL + partnerIDParam + sourceValue + campaignParam + campaignValue
            + utmSourceParam + sourceValue + utmCampaignParam + campaignValue + utmContentParam + contentValue;
  
  document.getElementById("source_url").innerHTML = window.location.href;
  document.getElementById("utm_source").innerHTML = sourceValue;
  document.getElementById("utm_campaign").innerHTML = campaignValue;
  document.getElementById("utm_content").innerHTML = contentValue;
  document.getElementById("final_url").innerHTML = finalURL;
  document.getElementById("link").href = finalURL;
  
  return finalURL;
}

</script>


<input type=button onClick="generateUrl()" value="Generate the link with UTM"><br><br>
<div>source_url: <b id="source_url"></b></div>
<div>utm_source: <b id="utm_source"></b></div>
<div>utm_campign: <b id="utm_campaign"></b></div>
<div>utm_content: <b id="utm_content"></b></div>
<div>final URL: <span id="final_url"></span></div>
<br><br>
<div><a id=link>test link</a></div>
